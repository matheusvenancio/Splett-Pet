<?xml version="1.0" encoding="ISO-8859-1"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui" xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	template="/layout/template.xhtml">
	<h:head>
		<f:metadata>
			<f:event type="preRenderView"
				listener="#{organizacaoMB.cadastroLoad}" />
			<f:event type="preRenderView"
				listener="#{organizacaoMB.findUsrLogado}" />
		</f:metadata>
	</h:head>
	<ui:define name="body">
		<h:form id="cadastroNegadoForm">
			<p:panelGrid
				style="text-align:center;width:80%;align:center;margin:0 auto;padding-top:30px !important"
				rendered="#{!organizacaoMB.usrAutorizado}" styleClass="semBorda">

				<p:row>
					<p:column>
						<h:outputText value="Desculpe, #{organizacaoMB.usuario.nome}."
							styleClass="f5" />
					</p:column>
				</p:row>
				<p:row>
					<p:column>
						<h:outputText
							value="Você deve completar seu cadastro para cadastrar uma Organização. "
							styleClass="f6" />
						<h:commandLink value="- Clique aqui."
							action="#{usuarioMB.paginaConfUsr()}" />
					</p:column>
				</p:row>
			</p:panelGrid>
		</h:form>

		<h:form rendered="#{usuarioMB.usuario.donoOrganizacao}"
			styleClass="alignCenter" style="width:300px">
			<p:panel>
				<h:outputText value="Voce ja possui uma organizacao!"
					styleClass="fonteErro" style="font-size:13px !important" />
			</p:panel>
		</h:form>

		<h:form id="cadastroForm"
			rendered="#{! usuarioMB.usuario.donoOrganizacao}">
			<p:panelGrid columns="1" styleClass="panelGrid"
				style="margin-left: auto; margin-right: auto; width:50%"
				rendered="#{organizacaoMB.usrAutorizado}">

				<h:panelGroup>
					<h:outputText value="Estado:" styleClass="f5" />
					<p:spacer width="20px" />
					<h:outputText id="estadoLabel" value="#{enderecoMB.estado.nome}" />
					<p:spacer width="10px" />
					<p:commandLink value=" - não é este?"
						onclick="alterarEndereco.show()" />
				</h:panelGroup>
				<p:separator />

				<h:panelGroup>
					<h:outputText value="Cidade:" styleClass="f5" />
					<p:spacer width="20px" />
					<h:outputText id="cidadeLabel" value="#{enderecoMB.cidade.nome}" />
					<p:spacer width="10px" />
					<p:commandLink value=" - não é este?"
						onclick="alterarEndereco.show()" />
				</h:panelGroup>
				<p:separator />

				<h:panelGroup>
					<h:outputText value="CEP: *" styleClass="f5" />
					<p:spacer width="20px" />
					<p:message for="cepTf" display="both" />
				</h:panelGroup>
				<p:inputMask id="cepTf" converter="ConverterEmptyToNull"
					value="#{organizacaoMB.endereco.cep}" mask="99999-999"
					maxlength="8" placeHolder=" "
					validatorMessage=" - algo está errado aqui!" required="true"
					requiredMessage=" este campo é obrigatório!" />
				<p:separator />

				<h:panelGroup>
					<h:outputText value="Bairro: *" styleClass="f5" />
					<p:spacer width="20px" />
					<p:message for="bairroTf" display="both" />
				</h:panelGroup>
				<p:inputText id="bairroTf" converter="ConverterEmptyToNull"
					value="#{organizacaoMB.endereco.bairro}"
					validatorMessage=" - algo está errado aqui!" required="true"
					requiredMessage=" este campo é obrigatório!" style="width:100%">
					<f:validateLength maximum="70" />
				</p:inputText>
				<p:separator />

				<h:panelGroup>
					<h:outputText value="Logradouro: *" styleClass="f5" />
					<p:spacer width="20px" />
					<p:message for="logradouroTf" display="both" />
				</h:panelGroup>
				<p:inputText id="logradouroTf"
					value="#{organizacaoMB.endereco.logradouro}"
					validatorMessage=" - algo está errado aqui!"
					converter="ConverterEmptyToNull" required="true"
					requiredMessage=" este campo é obrigatório!" style="width:100%">
					<f:validateLength minimum="5" maximum="80" />
				</p:inputText>
				<p:separator />

				<h:panelGroup>
					<h:outputText value="Número: *" styleClass="f5" />
					<p:spacer width="20px" />
					<p:message for="numeroTf" display="both" />
				</h:panelGroup>
				<p:inputMask id="numeroTf" converter="ConverterEmptyToNull"
					value="#{organizacaoMB.endereco.numero}" mask="9?9999"
					maxlength="5" placeHolder=" "
					validatorMessage=" - algo está errado aqui!" required="true"
					requiredMessage=" este campo é obrigatório!" style="width:100%" />
				<p:separator />

				<h:panelGroup>
					<h:outputText value="Complemento:* " styleClass="f5" />
					<p:spacer width="20px" />
					<p:message for="complementoTf" display="both" />
				</h:panelGroup>
				<p:inputText id="complementoTf" converter="ConverterEmptyToNull"
					value="#{organizacaoMB.endereco.complemento}"
					validatorMessage=" - algo está errado aqui!" required="true"
					requiredMessage=" este campo é obrigatório!">
					<f:validateLength maximum="30" />
				</p:inputText>
				<p:separator />

				<h:panelGroup>
					<h:outputText value="Nome: *" styleClass="f5" />
					<p:spacer width="20px" />
					<p:message for="nomeOrgTf" display="both" />
				</h:panelGroup>
				<p:inputText id="nomeOrgTf"
					value="#{organizacaoMB.organizacao.nome}" required="true"
					requiredMessage=" este campo é obrigatório!" style="width:100%">
					<f:validateLength minimum="3" maximum="30" />
				</p:inputText>
				<p:separator />

				<h:panelGroup>
					<h:outputText value="Telefone: *" styleClass="f5" />
					<p:spacer width="20px" />
					<p:message for="telefoneOrgTf" display="both" />

					<p:inputMask id="telefoneOrgTf" converter="ConverterEmptyToNull"
						value="#{organizacaoMB.organizacao.telefone}"
						mask="(99) 9999-9999" maxlength="5" placeHolder=" "
						validatorMessage=" - algo está errado aqui!" required="true"
						requiredMessage=" este campo é obrigatório!" />
				</h:panelGroup>
				<p:separator />

				<h:panelGroup>
					<p:message for="fileUpload" showDetail="true" />
					<center>
						<p:fileUpload id="fileUpload"
							fileUploadListener="#{arquivoMB.uploadOrg}" mode="advanced"
							dragDropSupport="false" sizeLimit="20971520" auto="true"
							fileLimit="5" showButtons="false" update="imgs"
							allowTypes="/(\.|\/)(jpe?g|png)$/" label="Adicionar imagens"
							multiple="false" style="width:40%; display: none !important;" />
						<br />
						<p:dataTable id="imgs" value="#{arquivoMB.arquivos}" var="arq"
							paginator="false" rows="6"
							emptyMessage="Nenhuma imagem adicionada."
							styleClass="hide-column-names"
							selection="#{arquivoMB.arqSelecionado}">
							<p:column selectionMode="single" style="width:2%" />
							<p:column>
								<p:graphicImage value="/image?nome=#{arq.nome}" height="100" />
							</p:column>
							<p:column>
								<h:outputText value="#{arq.nomeReal}" />
							</p:column>
							<p:column>
								<p:commandButton action="#{arquivoMB.removerImgPreview}"
									update="imgs" icon="ui-icon-trash" title="Remover"
									process="@this">
									<f:setPropertyActionListener target="#{arquivoMB.arqView}"
										value="#{arq}" />
								</p:commandButton>
								<p:spacer width="20px" />
								<p:commandButton onclick="visualizarArq.show()"
									update="imgs :visualizarArquivoForm :visualizarArquivoForm:panelDialogArq"
									icon="ui-icon-search" title="Visualizar" process="@this">
									<f:setPropertyActionListener target="#{arquivoMB.arqView}"
										value="#{arq}" />
								</p:commandButton>
							</p:column>
						</p:dataTable>
					</center>
				</h:panelGroup>
				<p:separator />



				<h:panelGroup>
					<h:outputText value="Proposta: *" styleClass="f5" />
					<p:spacer width="20px" />
					<p:message for="propostaTf" display="both" />
				</h:panelGroup>
				<p:inputTextarea id="propostaTf" converter="ConverterEmptyToNull"
					required="true" value="#{organizacaoMB.organizacao.proposta}"
					rows="8" cols="50" autoResize="false" counter="counterProposta"
					maxlength="500" counterTemplate="{0} caracteres restantes."
					style="width:100%" requiredMessage="Campo Obrigatorio" />
				<h:outputText id="counterProposta" />
				<p:separator />

				<h:panelGroup>
					<h:outputText value="Descrição:  *" styleClass="f5" />
					<p:spacer width="20px" />
					<p:message for="descricaoTf" display="both" />
				</h:panelGroup>

				<p:inputTextarea id="descricaoTf" converter="ConverterEmptyToNull"
					required="true" value="#{organizacaoMB.organizacao.descricao}"
					rows="8" cols="50" autoResize="false" counter="counterDescricao"
					maxlength="500" counterTemplate="{0} caracteres restantes."
					style="width:100%" requiredMessage="Campo Obrigatorio" />
				<h:outputText id="counterDescricao" styleClass="fonteDestaq"
					style="font-size:13px !important" />

				<p:separator style="background-color: #FFA500;border-color:#FFA500" />
				<p:column styleClass="alignCenter, f5" style="font-weight: bold;">
					<h:outputText value="Informacoes bancarias" styleClass="f5"
						style="margin-left:165px !important" />
					<p:spacer height="20px"></p:spacer>
				</p:column>
				<h:panelGroup>




					<p:commandButton value="cadastrar banco"
						onclick="cadastroBanco.show()" immediate="true"
						actionListener="#{bancoMB.novo}" update=":cadastrarBCForm">
					</p:commandButton>

					<p:dataTable id="bancos" value="#{bancoMB.bancosSelecionados}"
						var="banco" paginator="false" rows="6"
						emptyMessage="Nenhuma banco adicionado."
						styleClass="hide-column-names">
						<p:column>
							<h:outputText value="Tipo: #{bancoMB.tipoBanco}" />
						</p:column>

					</p:dataTable>
				</h:panelGroup>
			</p:panelGrid>

			<center>
				<h:outputText
					value="Nota: o cadastro de organização é efetuado após autorização do administrador."
					rendered="#{organizacaoMB.usrAutorizado}" styleClass="fonteDestaq"
					style="font-size:13px !important" />
			</center>
			<h:panelGrid id="gridBotoes" columns="2"
				style="margin-left: auto; margin-right: auto; width:40%"
				rendered="#{organizacaoMB.usrAutorizado}">

				<p:commandButton id="cancelarOrganizacaoBt" value="Cancelar"
					immediate="true" action="#{organizacaoMB.cancelar}"
					style="font-size:13px !important" />

				<p:commandButton id="salvarOrganizacao" value="Salvar"
					style="font-size:13px !important" action="#{organizacaoMB.salvar}"
					ajax="false" />
			</h:panelGrid>
		</h:form>

		<p:dialog id="bcCadastro" widgetVar="cadastroBanco" draggable="false"
			position="center" width="500" height="300">
			<h:form id="cadastrarBCForm">

				<h:panelGrid columns="1">
					<p:column>
						<h:outputText value="Banco suportado: *" styleClass="f5" />
						<!-- <p:inputText value="#{bancoMB.banco.nome}"></p:inputText> -->
						<p:selectOneRadio id="bancoOrg" required="true"
							requiredMessage="Este campo e obrigatorio" styleClass="f6"
							value="#{bancoMB.tipoBanco}"
							validator="#{bancoMB.atribuirTipoBanco}">
							<f:selectItem itemValue="BANCOBRASIL" itemLabel="Banco do Brasil">
							</f:selectItem>

							<f:selectItem itemValue="BRADESCO" itemLabel="Banco Bradesco">
							</f:selectItem>

							<f:selectItem itemValue="ITAU" itemLabel="Banco Itau">
							</f:selectItem>
							<f:ajax event="change"></f:ajax>
							

						</p:selectOneRadio>

						<h:outputText value="Nosso Numero: *" styleClass="f5"/>
						<p:message for="nossoNumMask" display="both" />
						<p:inputMask id="nossoNumMask" converter="ConverterEmptyToNull"
							required="true" requiredMessage="Campo obrigatorio"
							label="nossoNum" value="#{bancoMB.nossoNum}"
							validator="#{bancoMB.atribuirnossoNum}"
							maxlength="11" placeHolder=" ">
							<f:ajax event="blur"></f:ajax>
						</p:inputMask>
						<p:separator />
				
						<h:outputText value="Numero de carteira: " styleClass="f5" />
						<p:spacer width="20px" />
						<p:message for="numCartMsk" display="both" />
						<p:inputMask id="numCartMsk" converter="ConverterEmptyToNull"
							required="true" requiredMessage="Campo obrigatorio"
							validator="#{bancoMB.atribuirNumCarteira}" label="numCart"
							value="#{bancoMB.banco.numCarteira}" mask="99" maxlength="2"
							placeHolder=" ">
							<f:ajax event="blur"></f:ajax>
						</p:inputMask>
						<p:separator />

						<h:panelGroup>
							<h:outputText value="Agência: " styleClass="f5" />
							<p:message for="agenciaOrgTf" display="both" />
						</h:panelGroup>
						<p:inputMask id="agenciaOrgTf" converter="ConverterEmptyToNull"
							value="#{bancoMB.banco.numeroAgencia}" mask="9999-9"
							validator="#{bancoMB.atribuirAgenciaBanco}" required="true"
							requiredMessage="Campo obrigatorio" maxlength="8" placeHolder=" "
							validatorMessage=" - algo está errado aqui!">
							<f:ajax event="blur"></f:ajax>
						</p:inputMask>
						<p:separator />


						<h:outputText value="Conta: " styleClass="f5" />
						<p:message for="contaOrgTf" display="both" />
						<p:inputMask id="contaOrgTf" converter="ConverterEmptyToNull"
							required="true" requiredMessage="Campo obrigatorio"
							value="#{bancoMB.banco.numeroConta}" mask="99.999-9"
							validator="#{bancoMB.atribuirNumConta}" maxlength="8"
							placeHolder=" " validatorMessage=" - algo está errado aqui!">
							<f:ajax event="blur"></f:ajax>
						</p:inputMask>





						<p:separator />
						<p:commandButton value="Salvar Banco" immediate="true"
							actionListener="#{bancoMB.salvar}" onclick="cadastroBanco.hide()"
							update=":cadastroForm:bancos"></p:commandButton>
						<p:separator />
					</p:column>
				</h:panelGrid>

			</h:form>
		</p:dialog>

		<p:dialog id="visualizarArquivo" widgetVar="visualizarArq"
			showHeader="false" modal="true" appendToBody="true" resizable="false"
			draggable="false" position="center" width="500" height="600">
			<h:form id="visualizarArquivoForm">
				<h:panelGrid id="panelDialogArq" columns="1" style="margin:0 auto;"
					styleClass="panelGrid">
					<h:outputText value="#{arquivoMB.arqView.nomeReal}"
						style="font-size: 16px !important; font-family: sans-serif" />
					<br />
					<center>
						<p:graphicImage id="imgViewDialog"
							value="/image?nome=#{arquivoMB.arqView.nome}" />
						<p:commandButton actionListener="#{arquivoMB.removerImgPreview}"
							update=":cadastroForm:imgs" icon="ui-icon-trash"
							title="Visualizar" process="@this" onclick="visualizarArq.hide()" />
					</center>
				</h:panelGrid>
				<center>
					<p:commandButton onclick="visualizarArq.hide()" value="Fechar"
						update=":cadastroForm:imgs" icon="ui-icon-close" title="Fechar" />
				</center>
			</h:form>
		</p:dialog>

		<p:dialog id="alterarEnderecoDialog" widgetVar="alterarEndereco"
			header="Selecione" modal="true" appendToBody="true" width="400"
			height="150" resizable="false" draggable="false">
			<h:form id="alterarEndereçoForm">
				<p:panelGrid columns="2" style="align:center; width:100%"
					cellpadding="10">
					<h:outputText value="Estado: *" styleClass="f5" />
					<p:selectOneMenu id="estadoSelect" value="#{enderecoMB.estado}"
						effect="fade" converter="#{estadoConverter}"
						style="font-size:8px; font-family:sans-serif">
						<f:selectItem itemLabel="Selecione" itemValue="" />
						<f:selectItems value="#{enderecoMB.estados}" var="est"
							itemLabel="#{est.nome}" itemValue="#{est}" />
						<f:ajax event="change"
							listener="#{enderecoMB.findCidadesByEstado}"
							render="cidadeSelect" />
					</p:selectOneMenu>

					<h:outputText value="Cidade: *" styleClass="f5" />
					<p:selectOneMenu id="cidadeSelect" value="#{enderecoMB.cidade}"
						effect="fade" converter="#{cidadeConverter}"
						style="font-size:8px; font-family:sans-serif">
						<f:selectItem itemLabel="Selecione" itemValue="" />
						<f:selectItems value="#{enderecoMB.cidades}" var="cid"
							itemLabel="#{cid.nome}" itemValue="#{cid}" />
					</p:selectOneMenu>
				</p:panelGrid>

				<h:panelGrid columns="1" style="align:center; width:100%"
					cellpadding="10">
					<p:commandButton value="Pronto!" style="font-size:13px !important"
						update=":cadastroForm:estadoLabel :cadastroForm:cidadeLabel"
						onclick="alterarEnderecoDialog.hide()" process="@this" />
				</h:panelGrid>
			</h:form>
		</p:dialog>



	</ui:define>
</ui:composition>