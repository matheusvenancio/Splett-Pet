<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui" xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	template="/layout/template.xhtml">

	<ui:define name="body">
		<h:form id="cadastroForm">
			<p:wizard widgetVar="usr" flowListener="#{usuarioMB.onFlowProcess}"
				nextLabel="Próximo">

				
				<p:tab id="essenciais" title="Dados Essenciais"
					titleStyleClass="cabecarioWizardUsr">
					<p:panel header=" ">
						<h:panelGrid columns="1" styleClass="grid; f5"
							style="margin-left: auto; margin-right: auto; width:40%">

							<h:panelGroup>
								<h:outputText value="Nome: *" />
								<p:spacer width="20px" />
								<p:message for="nomeTf" display="both" />
							</h:panelGroup>
							<p:inputText id="nomeTf" required="true" label="nome"
								value="#{usuarioMB.usuario.nome}"
								requiredMessage="este campo é obrigatório."
								validatorMessage="Algo está errado aqui!" style="width:100%">
								<f:validateLength minimum="3" maximum="30" />
							</p:inputText>
							<h:outputText value="3-30 caract." styleClass="fonteObs"
								style="text-align:right" />
							<p:separator />

							<h:panelGroup>
								<h:outputText value="Sobrenome: *" />
								<p:spacer width="20px" />
								<p:message for="sobrenomeTf" display="both" />
							</h:panelGroup>
							<p:inputText id="sobrenomeTf" required="true" label="sobrenome"
								value="#{usuarioMB.usuario.sobrenome}"
								requiredMessage="este campo é obrigatório."
								validatorMessage="Algo está errado aqui!" style="width:100%">
								<f:validateLength minimum="4" maximum="60" />
							</p:inputText>
							<h:outputText value="4-60 caract." styleClass="fonteObs" />
							<p:separator />

							<h:panelGroup>
								<h:outputText value="Login: *" />
								<p:spacer width="20px" />
							</h:panelGroup>
							<p:inputText id="loginTf" required="true"
								value="#{usuarioMB.usuario.username}"
								requiredMessage="Este campo é obrigatório." style="width:100%"
								validator="#{usuarioMB.validarLogin}">
								<f:ajax event="blur" render="loginMsg" />
								<f:validateLength minimum="3" maximum="15" />
							</p:inputText>
							<p:message for="loginTf" id="loginMsg" />
							<h:outputText value="3-15 caract." styleClass="fonteObs" />
							<p:separator />

							<h:panelGroup>
								<h:outputText value="E-mail: *" />
								<p:spacer width="20px" />
							</h:panelGroup>
							<p:inputText id="emailTf" required="true"
								value="#{usuarioMB.usuario.email}"
								validator="#{usuarioMB.validarEmail}"
								requiredMessage="Este campo é obrigatório." style="width:100%">
								<p:ajax event="blur" update="emailMsg" />
								<f:validateRegex
									pattern="[\w\.-]*[a-zA-Z0-9_]@[\w\.-]*[a-zA-Z0-9]\.[a-zA-Z][a-zA-Z\.]*[a-zA-Z]" />
							</p:inputText>
							<p:message for="emailTf" id="emailMsg" />
							<h:outputText value="6-35 caract." styleClass="fonteObs" />
							<p:separator />

							<h:panelGroup>
								<h:outputText for="pwd1" value="Senha: *" />
								<p:spacer width="20px" />
								<p:message for="senha1Tf" display="both" />
							</h:panelGroup>
							<p:password id="senha1Tf" value="#{usuarioMB.usuario.password}"
								match="senha2Tf" required="true" feedback="true"
								requiredMessage="Este campo é obrigatório."
								validatorMessage="Algo está errado aqui!" style="width:100%">
								<f:validateLength minimum="6" maximum="15" />
							</p:password>
							<h:outputText value="6-15 caract." styleClass="fonteObs" />
							<p:separator />

							<h:panelGroup>
								<h:outputText for="pwd2" value="Confirme a Senha: *" />
								<p:spacer width="20px" />
								<p:message for="senha2Tf" display="both" />
							</h:panelGroup>
							<p:password id="senha2Tf" value="#{usuarioMB.usuario.password}"
								label="senha2" required="true"
								requiredMessage="Este campo é obrigatório."
								validatorMessage="Algo está errado aqui!" style="width:100%" />
							<h:outputText value="6-15 caract." styleClass="fonteObs" />
							<p:separator />

							<h:panelGroup>
								<h:outputText value="Pular para confirmação: " />
								<p:spacer width="20px" />
								<p:selectBooleanCheckbox value="#{usuarioMB.skip}" />
							</h:panelGroup>

							<h:outputText value="* todos os campos são obrigatórios"
								styleClass="fonteObsAlignRight" />
						</h:panelGrid>
					</p:panel>
				</p:tab>

				<!-- aqui fica o tab dos dados residenciais -->
<p:tab id="residenciais" title="Dados Residenciais"
					titleStyleClass="cabecarioWizardUsr">
					<p:panel header=" ">
						<h:panelGrid columns="1"
							style="margin-left: auto; margin-right: auto; width:40%">
							<h:panelGroup>
								<h:outputText value="Estado:" styleClass="f5" />
								<p:spacer width="20px" />
								<h:outputText value="#{usuarioMB.usuario.endereco.estado.nome}"
									rendered="#{usuarioMB.usuario.endereco.estado.nome != null}" />
								<p:selectOneMenu id="estadoSelect" value="#{enderecoMB.estado}"
									effect="fade" converter="#{estadoConverter}"
									rendered="#{usuarioMB.usuario.endereco.estado.nome == null}"
									style="font-size:8px; font-family:sans-serif">
									<f:selectItem itemLabel="Selecione" itemValue="" />
									<f:selectItems value="#{enderecoMB.estados}" var="est"
										itemLabel="#{est.nome}" itemValue="#{est}" />
									<f:ajax event="change"
										listener="#{enderecoMB.findCidadesByEstado}"
										render="cidadeSelect" />
								</p:selectOneMenu>
								<p:separator />
							</h:panelGroup>

							<p:message display="both" for="cidadeSelect" />
							<h:panelGroup>
								<h:outputText value="Cidade:" styleClass="f5" />
								<p:spacer width="20px" />
								<h:outputText value="#{usuarioMB.usuario.endereco.cidade.nome}"
									rendered="#{usuarioMB.usuario.endereco.cidade.nome != null}" />
								<p:selectOneMenu id="cidadeSelect" value="#{enderecoMB.cidade}"
									effect="fade" converter="#{cidadeConverter}"
									rendered="#{usuarioMB.usuario.endereco.cidade.nome == null}"
									style="font-size:8px; font-family:sans-serif">
									<f:selectItem itemLabel="Selecione" itemValue="" />
									<f:selectItems value="#{enderecoMB.cidades}" var="cid"
										itemLabel="#{cid.nome}" itemValue="#{cid}" />
								</p:selectOneMenu>
								<p:separator />
							</h:panelGroup>

							<h:panelGroup>
							
								<h:outputText value="Bairro: " styleClass="f5" />
								<p:inputText id="bairroTf"
									value="#{usuarioMB.endereco.bairro}" style="width:100%"
									styleClass="f6"/>
								<p:separator />
							</h:panelGroup>

							<h:outputText id="logradouroTf" value="Logradouro: "
								styleClass="f5" />
							<p:inputText value="#{usuarioMB.endereco.logradouro}"
								styleClass="f6" style="width:100%" />
							<p:separator />

						<h:panelGroup>
								<h:outputText value="Complemento: " styleClass="f5" />
								<p:inputText id="complementoTf"
									value="#{usuarioMB.endereco.complemento}" size="10" />
								<p:spacer width="20px" />
								<h:outputText value="N˙mero: " styleClass="f5" />
								<p:inputMask id="numeroTf" converter="ConverterEmptyToNull"
									value="#{usuarioMB.endereco.numero}" mask="9?9999"
									maxlength="5" placeHolder=" " size="4"
									validatorMessage="Algo est· errado aqui! " />
							</h:panelGroup>
							<p:separator />

							<h:panelGroup>
								<h:outputText value="Pular para confirmação: " />
								<p:spacer width="20px" />
								<p:selectBooleanCheckbox value="#{usuarioMB.skip}" />
							</h:panelGroup>

							<h:outputText
								value="Você pode preencher ou alterar estes dados em outros acessos."
								styleClass="fonteInfoDestaq" />
							<h:outputText
								value="Os dados pessoais serão inicialmente privados, mas você poderá torna-los públicos."
								styleClass="fonteObsAlignRight" />
						</h:panelGrid>
					</p:panel>
				</p:tab>
				<p:tab id="contato" title="Dados para Contato"
					titleStyleClass="cabecarioWizardUsr"
					style="margin-left: auto; margin-right: auto; width:40%">
					<p:panel header=" ">
						<h:panelGrid columns="1">
							<h:panelGroup>
								<h:outputText value="Telefone Residencial: " />
								<p:spacer width="20px" />
								<p:messages for="telResTf" display="both" />
							</h:panelGroup>
							<p:inputMask id="telResTf" converter="ConverterEmptyToNull"
								label="telefoneRes" value="#{usuarioMB.usuario.telefoneRes}"
								mask="(99) 9999-9999" maxlength="13" placeHolder=" " />

							<h:panelGroup>
								<h:outputText value="Telefone Celular: " />
								<p:spacer width="20px" />
								<p:messages for="telCelTf" display="both" />
							</h:panelGroup>
							<p:inputMask id="telCelTf" converter="ConverterEmptyToNull"
								label="telefoneCel" value="#{usuarioMB.usuario.telefoneCel}"
								mask="(99) 9999-9999" maxlength="13" placeHolder=" " />

							<h:panelGroup>
								<h:outputText value="Pular para confirmação: " />
								<p:spacer width="20px" />
								<p:selectBooleanCheckbox value="#{usuarioMB.skip}" />
							</h:panelGroup>
							<h:outputText
								value="Você pode preencher ou alterar estes dados em outros acessos."
								styleClass="fonteInfoDestaq" />
							<h:outputText
								value="Os dados pessoais serão inicialmente privados, mas você poderá torna-los públicos."
								styleClass="fonteObsAlignRight" />
						</h:panelGrid>
					</p:panel>
				</p:tab>

				<!-- tab da imagem para perfil -->
				<p:tab id="adicionais" title="Dados Adicionais"
					titleStyleClass="cabecarioWizardUsr">
					<p:panel header=" ">
						<h:panelGrid columns="1" styleClass="alignCenter">
							<center>
								<h:graphicImage id="imgAvatar"
									value="/image?nome=#{usuarioMB.usuario.avatar.nome}"
									height="300" width="250" />
								<h:panelGrid columns="2"
									style="text-align: center !important; margin-right: auto;">
									<p:fileUpload id="fileUpload" auto="true"
										fileUploadListener="#{arquivoMB.uploadAvatar}" mode="advanced"
										dragDropSupport="false" sizeLimit="20971520" fileLimit="1"
										allowTypes="/(\.|\/)(jpe?g|png)$/" label="Escolher"
										invalidFileMessage="O arquivo selecionado n„o È v·lido!"
										invalidSizeMessage="O tamanho do arquivo n„o È aceito!"
										showButtons="false" multiple="false" style="font-size:8px" />
									<p:commandButton actionListener="#{arquivoMB.removerAvatar}"
										value="Remover avatar" style="font-size:15px"
										icon="ui-icon-close" />
								</h:panelGrid>
							</center>
							<h:panelGroup>
								<h:outputText value="Sobre você: " styleClass="f5" />
								<p:spacer width="20px" />
								<p:message for="bioTf" display="both" />
							</h:panelGroup>
							<p:inputTextarea id="bioTf" converter="ConverterEmptyToNull"
								required="false" label="bio" value="#{usuarioMB.usuario.bio}"
								rows="8" cols="50" autoResize="false" counter="counter"
								maxlength="300" counterTemplate="{0} characters remaining." />
							<h:outputText id="counter" />
							<h:panelGrid>
								<h:outputText value="Sexo: " />
								<p:selectOneMenu id="sexoUsr" effet="fade"
									value="#{usuarioMB.usuario.sexoUsuario}">
									<f:selectItem itemLabel="Selecione" itemValue="" />
									<f:selectItem itemLabel="Feminino" itemValue="FEMININO" />
									<f:selectItem itemLabel="Masculino" itemValue="MASCULINO" />
								</p:selectOneMenu>
							</h:panelGrid>
							<h:outputText
								value="Você pode preencher ou alterar estes dados em outros acessos."
								styleClass="fonteInfoDestaq" />
						</h:panelGrid>
					</p:panel>
				</p:tab>



				<p:tab id="confirm" title="Confirmar"
					titleStyleClass="cabecarioWizardUsr">
					<p:panel id="pnl" header=" ">

						<p:panelGrid id="confirmarGrid">
							<f:facet name="header">
								<p:row>
									<p:column colspan="2">Dados Essenciais</p:column>
									<p:column colspan="2">Dados Residenciais</p:column>
									<p:column colspan="2">Dados para Contato</p:column>
									<p:column colspan="2">Dados Adicionais</p:column>
								</p:row>
							</f:facet>
							<p:row>
								<p:column>
									<h:outputText value="Nome: " />
								</p:column>
								<p:column style="font-weight: bold">
									<h:outputText styleClass="outputLabel"
										value="#{usuarioMB.usuario.nome}" />
								</p:column>
								<p:column>
									<h:outputText value="Logradouro: " />
								</p:column>
								<p:column style="font-weight: bold">
									<h:outputText styleClass="outputLabel"
										value="#{usuarioMB.endereco.logradouro}" />
								</p:column>
								<p:column>
									<h:outputText value="Telefone Residencial: " />
								</p:column>
								<p:column style="font-weight: bold">
									<h:outputText styleClass="outputLabel"
										value="#{usuarioMB.usuario.telefoneRes}" />
								</p:column>
								<p:column>
									<h:outputText value="Sobre você: " />
								</p:column>
							</p:row>

							<p:row>
								<p:column>
									<h:outputText value="Sobrenome: " />
								</p:column>
								<p:column style="font-weight: bold">
									<h:outputText styleClass="outputLabel"
										value="#{usuarioMB.usuario.sobrenome}" />
								</p:column>
								<p:column>
									<h:outputText value="Número: " />
								</p:column>
								<p:column style="font-weight: bold">
									<h:outputText styleClass="outputLabel"
										value="#{usuarioMB.endereco.numero}" />
								</p:column>
								<p:column>
									<h:outputText value="Telefone Celular: " />
								</p:column>
								<p:column style="font-weight: bold">
									<h:outputText styleClass="outputLabel"
										value="#{usuarioMB.usuario.telefoneCel}" />
								</p:column>
								<p:column rowspan="4"
									style="font-weight: bold; max-height:150px;">
									<h:outputText styleClass="outputLabel"
										value="#{usuarioMB.usuario.bio}" />
								</p:column>
							</p:row>

							<p:row>
								<p:column>
									<h:outputText value="Login: " />
								</p:column>
								<p:column style="font-weight: bold">
									<h:outputText styleClass="outputLabel"
										value="#{usuarioMB.usuario.username}" />
								</p:column>
								<p:column>
									<h:outputText value="Complemento: " />
								</p:column>
								<p:column style="font-weight: bold">
									<h:outputText styleClass="outputLabel"
										value="#{usuarioMB.endereco.complemento}" />
								</p:column>
								<p:column colspan="2" styleClass="ui-widget-header">
									<p:spacer height="0" />
								</p:column>
							</p:row>

							<p:row>
								<p:column>
									<h:outputText value="E-mail: " />
								</p:column>
								<p:column style="font-weight: bold">
									<h:outputText styleClass="outputLabel"
										value="#{usuarioMB.usuario.email}" />
								</p:column>
								<p:column>
									<h:outputText value="CEP: " />
								</p:column>
								<p:column style="font-weight: bold">
									<h:outputText styleClass="outputLabel"
										value="#{usuarioMB.endereco.cep}" />
								</p:column>
								<p:column colspan="2" styleClass="ui-widget-header">
									<p:spacer height="0" />
								</p:column>
							</p:row>

							<p:row>
								<p:column colspan="2" styleClass="ui-widget-header">
									<p:spacer height="0" />
								</p:column>
								<p:column>
									<h:outputText value="Bairro: " />
								</p:column>
								<p:column style="font-weight: bold">
									<h:outputText styleClass="outputLabel"
										value="#{usuarioMB.endereco.bairro}" />
								</p:column>
								<p:column colspan="2" styleClass="ui-widget-header">
									<p:spacer height="0" />
								</p:column>
							</p:row>

							<p:row>
								<p:column colspan="2" styleClass="ui-widget-header">
									<p:spacer height="0" />
								</p:column>
								<p:column>
									<h:outputText value="Cidade: " />
								</p:column>
								<p:column style="font-weight: bold">
									<h:outputText styleClass="outputLabel"
										value="#{usuarioMB.endereco.cidade}" />
								</p:column>
								<p:column colspan="3" styleClass="ui-widget-header">
									<p:spacer height="0" />
								</p:column>
							</p:row>
						</p:panelGrid>
						<p:commandButton id="btSalvar" value="Salvar" action="#{usuarioMB.salvar}"
							immediate="true"/>
							<p:blockUI block="pnl" trigger="btSalvar">
							<h:outputText value="Carregando.." styleClass="fonteLaranja" style="font-size:'12px !important'"/>
							  <p:graphicImage value="/img/carregando.gif"/>  
							</p:blockUI>  
					</p:panel>
				</p:tab>
			</p:wizard>
		</h:form>

		<h:form id="ajusteImagemForm">
			<p:dialog id="ajustarImgDialog" widgetVar="ajustarImg"
				header="Ajustar Imagem" width="600" height="300">
				<h:panelGrid id="painel" columns="2">
					<p:imageCropper id="imgCropper" value="#{arquivoMB.imgCropped}"
						image="/resources/upload/avatar/#{arquivoMB.imgPreviewName}"
						initialCoords="0,0,300,125" />
					<p:graphicImage id="imgCroppedPreview"
						value="/resources/upload/avatar/#{arquivoMB.imgNomeNew}" />
				</h:panelGrid>
				<p:commandButton value="Visualizar" action="#{arquivoMB.crop}"
					update="imgCroppedPreview" />
			</p:dialog>
		</h:form>
	</ui:define>
</ui:composition>